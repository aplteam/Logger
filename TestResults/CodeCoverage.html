<!DOCTYPE html>
<html lang="en">
<head>
<title>Coverage</title>
<meta charset="utf-8"/>
<style>
@media screen{
    html {background-color: #FFFFF0;}
body {
    font-size: 16px;
    font-family : Verdana, "Bitstream Vera Sans", "DejaVu Sans", Tahoma, Geneva, Arial, Sans-serif;
    margin: 1em;
}
th, td {padding: 5px 10px;}
th {text-align: left;}
h1, h2, h3, h4, h5, h6 {color: #424242;}
h1 {font-size: 22px;}
h2 {font-size: 18px; margin-top: 2em; margin-bottom:0.3em;}
tbody tr:nth-child(even) {background-color: #F0F0F0;}
tbody tr:nth-child(odd) {background-color: #FAFAFA;}
th {background-color: #E6E6E6;color: #424242;}
table {border: silver 1px solid; font-size: 14px;font-family: APLFont, monospace;}
code , code a {font-size: 14px; font-family: APLFont, monospace;}
code.header {
    font-size: 16px; 
    font-family: APLFont, monospace; 
    margin: 1.5em 0.5em 0 0.5em; 
    padding:0;
    display: block;
}
div.code-block {
    border: 1px silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 0.5em 0.5em 0.5em 0.5em;
    padding: 0.5em;
}
div.code-block.missing {
    background-color: #fa605254;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
ul li, ol li {margin: 0.7em 0.2em;}
.float-right {float:right;}
.no-underline {    text-decoration :none;}
.top-links {font-size:20px; padding-left: 0.6em;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5px; padding-top:0; font-size: 9px;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 0.5em; padding: 0.5em;}
}
@media print{@page {size: portrait}
@page {
    margin: 1cm 1cm 1cm 1.75cm;
    @bottom-right {
        content: counter(page) " / " counter(pages);
  }
}
body {
    font: 12pt "Times New Roman", Times, serif;
    line-height: 1.2;
     /* CSS3 filter, at the moment Webkit only. Prefix it for future implementations */
    -webkit-filter: grayscale(100%);
    filter: grayscale(100%); /* future-proof */
}
h1 {font-size: 18pt;}
h2 {font-size: 16pt; margin-top: 10pt; margin-bottom: 3pt;}
th, td {padding: 2pt 3pt;}
th {text-align: left;background-color: #DBDBDB;}
tbody tr:nth-child(odd) {background-color: #EDEDED;}
table {
    color-adjust: exact !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    font-size: 8pt;
    font-family: APLFont, monospace;
}
div.keep-together {break-inside: avoid; break-before:auto;}
table {border: silver 1pt solid;}
code , code a {font-size: 8pt; font-family: APLFont, monospace;}
code.header {
    font-size: 8pt;
    font-family: APLFont, monospace;
    margin: 7pt 3pt 0 10pt;
    padding:0;
    display: block;
}
div.code-block {
    border: 1pt silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 4pt 4pt 4pt 4pt;
    padding: 4pt;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
a {text-decoration: none;color: black;}
ul li, ol li {margin: 8pt 3pt;}
.no-print {display:none;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5pt; padding-top:0; font-size: 6pt;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 8px; padding: 8px;}
}
</style>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.js"></script>
</head>
<body>
<h1 id="top">Coverage Report</h1>
<p>Watched: 61 fns/opr within <code>#.Logger.Logger</code></p>
<p>The test suite was executed once:</p>
<table>
<thead>
<tr><th>Executed at</th><th>APLVersion</th><th>Memory (MB)</th></tr>
</thead>
<tbody>
<tr><td>2025-04-09 10:45:45</td><td>Windows-64 ⋄ 19.0.51432.0 ⋄ W ⋄ Development ⋄ Unicode</td><td>113</td></tr>
</tbody>
</table>
<p>Overall 89% of the testable code is covered.</p>
<p>(Comment lines, empty lines, all <code>:End</code>* lines etc. are ignored)</p>
<p>47 of the fns/opr are 100% covered.</p>
<div id="partly-covered" class="keep-together">
<table id="percent">
<thead>
<tr><th style="text-align:left;">Function/Operator</th><th style="text-align:left;">Lines not executed</th><th style="text-align:left;">Coverage</th><th style="text-align:right;">≢</th></tr>
</thead>
<tbody>
<tr><td><a href="#listing_1" title="Link to listing">#.Logger.Logger.Open</a></td><td>15←≢10-12,21-23,34-37,40,44-47</td><td>58</td><td>36</td></tr>
<tr><td><a href="#listing_2" title="Link to listing">#.Logger.Logger.Version</a></td><td>9</td><td>67</td><td>3</td></tr>
<tr><td><a href="#listing_3" title="Link to listing">#.Logger.Logger.SetTrap</a></td><td>6</td><td>67</td><td>3</td></tr>
<tr><td><a href="#listing_4" title="Link to listing">#.Logger.Logger.MakeNewFilename</a></td><td>4←≢15-18</td><td>69</td><td>13</td></tr>
<tr><td><a href="#listing_5" title="Link to listing">#.Logger.Logger.WriteToLogfile</a></td><td>9←≢8,14-15,26,33-36,41</td><td>74</td><td>34</td></tr>
<tr><td><a href="#listing_6" title="Link to listing">#.Logger.Logger.ApplyMakeUp</a></td><td>10, 13, 22</td><td>80</td><td>15</td></tr>
<tr><td><a href="#listing_7" title="Link to listing">#.Logger.Logger.Timestamp</a></td><td>14</td><td>89</td><td>9</td></tr>
<tr><td><a href="#listing_8" title="Link to listing">#.Logger.Logger.CheckForReopen</a></td><td>8, 9</td><td>89</td><td>18</td></tr>
<tr><td><a href="#listing_9" title="Link to listing">#.Logger.Logger.HandleEncoding</a></td><td>10</td><td>89</td><td>9</td></tr>
<tr><td><a href="#listing_10" title="Link to listing">#.Logger.Logger.make4</a></td><td>9</td><td>91</td><td>11</td></tr>
<tr><td><a href="#listing_11" title="Link to listing">#.Logger.Logger.Log</a></td><td>21</td><td>91</td><td>11</td></tr>
<tr><td><a href="#listing_12" title="Link to listing">#.Logger.Logger.make5</a></td><td>10</td><td>92</td><td>12</td></tr>
<tr><td><a href="#listing_13" title="Link to listing">#.Logger.Logger.make1</a></td><td>31</td><td>96</td><td>25</td></tr>
<tr><td><a href="#listing_14" title="Link to listing">#.Logger.Logger.LogError</a></td><td>25</td><td>96</td><td>26</td></tr>
<tr class="fullyCovered"><td><a href="#listing_15" title="Link to listing">#.Logger.Logger.set_encoding</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_16" title="Link to listing">#.Logger.Logger.get_encoding</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_17" title="Link to listing">#.Logger.Logger.set_autoReOpen</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_18" title="Link to listing">#.Logger.Logger.get_autoReOpen</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_19" title="Link to listing">#.Logger.Logger.set_filenameType</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_20" title="Link to listing">#.Logger.Logger.get_filenameType</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_21" title="Link to listing">#.Logger.Logger.set_debug</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_22" title="Link to listing">#.Logger.Logger.get_debug</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_23" title="Link to listing">#.Logger.Logger.set_printToSession</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_24" title="Link to listing">#.Logger.Logger.get_printToSession</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_25" title="Link to listing">#.Logger.Logger.set_extension</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_26" title="Link to listing">#.Logger.Logger.get_extension</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_27" title="Link to listing">#.Logger.Logger.set_timestamp</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_28" title="Link to listing">#.Logger.Logger.get_timestamp</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_29" title="Link to listing">#.Logger.Logger.set_active</a></td><td></td><td>100</td><td>7</td></tr>
<tr class="fullyCovered"><td><a href="#listing_30" title="Link to listing">#.Logger.Logger.get_active</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_31" title="Link to listing">#.Logger.Logger.set_fileFlag</a></td><td></td><td>100</td><td>7</td></tr>
<tr class="fullyCovered"><td><a href="#listing_32" title="Link to listing">#.Logger.Logger.get_fileFlag</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_33" title="Link to listing">#.Logger.Logger.set_filenamePrefix</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_34" title="Link to listing">#.Logger.Logger.get_filenamePrefix</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_35" title="Link to listing">#.Logger.Logger.set_filenamePostfix</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_36" title="Link to listing">#.Logger.Logger.get_filenamePostfix</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_37" title="Link to listing">#.Logger.Logger.set_errorPrefix</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_38" title="Link to listing">#.Logger.Logger.get_errorPrefix</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_39" title="Link to listing">#.Logger.Logger.set_path</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_40" title="Link to listing">#.Logger.Logger.get_path</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_41" title="Link to listing">#.Logger.Logger.set_filename</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_42" title="Link to listing">#.Logger.Logger.get_filename</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_43" title="Link to listing">#.Logger.Logger.set_fileDescriptor</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_44" title="Link to listing">#.Logger.Logger.get_fileDescriptor</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_45" title="Link to listing">#.Logger.Logger.set_errorCounter</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_46" title="Link to listing">#.Logger.Logger.get_errorCounter</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_47" title="Link to listing">#.Logger.Logger.History</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_48" title="Link to listing">#.Logger.Logger.make0</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_49" title="Link to listing">#.Logger.Logger.make2</a></td><td></td><td>100</td><td>8</td></tr>
<tr class="fullyCovered"><td><a href="#listing_50" title="Link to listing">#.Logger.Logger.make3</a></td><td></td><td>100</td><td>9</td></tr>
<tr class="fullyCovered"><td><a href="#listing_51" title="Link to listing">#.Logger.Logger.InitialyzeProperties</a></td><td></td><td>100</td><td>16</td></tr>
<tr class="fullyCovered"><td><a href="#listing_52" title="Link to listing">#.Logger.Logger.Create</a></td><td></td><td>100</td><td>8</td></tr>
<tr class="fullyCovered"><td><a href="#listing_53" title="Link to listing">#.Logger.Logger.Init</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_54" title="Link to listing">#.Logger.Logger.CreateParms</a></td><td></td><td>100</td><td>17</td></tr>
<tr class="fullyCovered"><td><a href="#listing_55" title="Link to listing">#.Logger.Logger.CreatePropertySpace</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_56" title="Link to listing">#.Logger.Logger.Close</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_57" title="Link to listing">#.Logger.Logger.FullFilename</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_58" title="Link to listing">#.Logger.Logger.MassageErrorMessage</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_59" title="Link to listing">#.Logger.Logger.Cleanup</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_60" title="Link to listing">#.Logger.Logger.Close2</a></td><td></td><td>100</td><td>8</td></tr>
<tr class="fullyCovered"><td><a href="#listing_61" title="Link to listing">#.Logger.Logger.SetDisplayFormat</a></td><td></td><td>100</td><td>2</td></tr>
</tbody>
</table>
</div>
<script>
$(document).ready(function() {
    var oTable;
    oTable = $("#percent").DataTable( {
        paging:   false,
        ordering: true,
        info:     true,
        fixedHeader: true,
        order: [2,"asc"],
        dom: "Bft",
        drawCallback: function( settings ) {
             var api = this.api();
             $('.header[id^="listing_"]').next().addBack().css("display","none");
             api.rows( {page:"current"} ).data().each(function(data){
              id = data[0];
              id = id.match(/"(\#.*?)"/);
              if (id){$(id[1]).next().addBack().css("display","block");}
             })
        },      
        buttons: [
        {
            text: "Partly covered (14)",
            titleAttr: "50%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^(?!(0%|100%)).*";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Uncovered (0)",
            titleAttr: "0%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^0%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Fully covered (47)",
            titleAttr: "100%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "100%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "All (61)",
            titleAttr: "all",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = ".";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
    ],
 
        columnDefs: [
            {className: "align-right", targets: [2,3]
            },
            {
                render: function ( data, type, row, meta ) {
                            return data+"%" ;        
                        },
                targets: 2
            }
        ]             
    } );
    oTable.button(0).trigger();

} );    
</script>
<h2>Listings</h2>
<code class="header" id="listing_1">#.Logger.Logger.Open &mdash; 58%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {(r msg)}←Open newFilename</code>
<code> [1]      ⍝ Open the log file. Any directory requested but non-existent is created here as well.</code>
<code> [2]   r←0</code>
<code> [3]   msg←''</code>
<code> [4]   :If _active∧_fileFlag</code>
<code> [5]       :Trap SetTrap 0</code>
<code> [6]           _filenameType←1 ⎕C _filenameType</code>
<code> [7]           :If 0=≢newFilename</code>
<code> [8]               (rc hint newFilename)←MakeNewFilename''</code>
<code> [9]               :If 0≠rc</code>
<code class="emphasize">→[10]                  msg←'Could not create new filename from "filenameType" and "path"'</code>
<code class="emphasize">→[11]                  msg ⎕SIGNAL _debug/11</code>
<code class="emphasize">→[12]                  →0,r←1</code>
<code> [13]              :EndIf</code>
<code> [14]          :EndIf</code>
<code> [15]          :If '.'≠⊃¯4↑newFilename</code>
<code> [16]              newFilename,←'.',_extension</code>
<code> [17]          :EndIf</code>
<code> [18]          _filename←newFilename</code>
<code> [19]          :If 0≠≢_path</code>
<code> [20]              :If ~'CREATE!'F.CheckPath _path</code>
<code class="emphasize">→[21]                  msg←'Could not open the log file, check the path'</code>
<code class="emphasize">→[22]                  msg ⎕SIGNAL _debug/11</code>
<code class="emphasize">→[23]                  →0,r←1</code>
<code> [24]              :EndIf</code>
<code> [25]          :EndIf</code>
<code> [26]          ⎕RL←+/⎕TS</code>
<code> [27]          fno←-?99999999 ⍝ See "Close" for details why we are doing this!</code>
<code> [28]          :Trap 0</code>
<code> [29]              _fileDescriptor←FullFilename F.NCREATE fno</code>
<code> [30]          :Case 22</code>
<code> [31]              :Trap SetTrap 0</code>
<code> [32]                  _fileDescriptor←FullFilename ⎕NTIE fno ⍝ 66 ⍝ grant all to all!</code>
<code> [33]              :Else</code>
<code class="emphasize">→[34]                  qdmx←⎕DMX</code>
<code class="emphasize">→[35]                  msg←'Error during open of logfiles: ',qdmx.EM</code>
<code class="emphasize">→[36]                  msg ⎕SIGNAL _debug/qdmx.EN</code>
<code class="emphasize">→[37]                  →0,r←1</code>
<code> [38]              :EndTrap</code>
<code> [39]          :Else</code>
<code class="emphasize">→[40]              ⎕SIGNAL 11</code>
<code> [41]          :EndTrap</code>
<code> [42]          ((Timestamp 1),' ','*** Log File opened',CrLf)⎕NAPPEND _fileDescriptor 80</code>
<code> [43]      :Else</code>
<code class="emphasize">→[44]          msg←'Error during open of logfiles'</code>
<code class="emphasize">→[45]          qdmx←⎕DMX</code>
<code class="emphasize">→[46]          msg ⎕SIGNAL _debug/qdmx.EN</code>
<code class="emphasize">→[47]          r←1</code>
<code> [48]      :EndTrap</code>
<code> [49]  :EndIf</code>
</div>
<code class="header" id="listing_2">#.Logger.Logger.Version &mdash; 67%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Version</code>
<code> [1]      ⍝ Returns the version number from `TatinVars` if possible.</code>
<code> [2]      ⍝ See also `History`</code>
<code> [3]   :Access Public shared</code>
<code> [4]   :If 0&lt;##.⎕NC'TatinVars.CONFIG'</code>
<code> [5]       r←(⎕JSON⍠('Dialect' 'JSON5')⊢##.TatinVars.CONFIG).version</code>
<code> [6]   :Else</code>
<code> [7]      ⍝ When a script was not loaded with Tatin, there will be no namespace `TatinVars`.</code>
<code> [8]      ⍝ In such cases we cannot provide a version number, so we return just ''.</code>
<code class="emphasize">→[9]       r←''</code>
<code> [10]  :EndIf</code>
</div>
<code class="header" id="listing_3">#.Logger.Logger.SetTrap &mdash; 67%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←SetTrap events</code>
<code> [1]      ⍝ R gets 1 if error trapping is appropriate according to the _</code>
<code> [2]      ⍝ global _debug variable</code>
<code> [3]  :Trap 0</code>
<code> [4]      r←(~_debug)/events</code>
<code> [5]  :Else</code>
<code class="emphasize">→[6]      r←events</code>
<code> [7]  :EndTrap</code>
</div>
<code class="header" id="listing_4">#.Logger.Logger.MakeNewFilename &mdash; 69%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (rc more filename)←MakeNewFilename filename</code>
<code> [1]      ⍝ Compiles a new filename and takes any changes in the timestamp into account.\\</code>
<code> [2]      ⍝ As a result, the compiled filename might differ from the one used so far.</code>
<code> [3]      ⍝ In that case, obviously the log file needs to be re-opened when `autoReOpen ←→ 1`.</code>
<code> [4]   rc←0 ⋄ more←''</code>
<code> [5]   :Trap SetTrap 0</code>
<code> [6]       :If _autoReOpen</code>
<code> [7]           filename←(8↑Timestamp 0)↑⍨('DATE' 'MONTH' 'YEAR'⍳⊂_filenameType)⊃8 6 4 0</code>
<code> [8]       :ElseIf 0≠≢_filename</code>
<code> [9]           filename←_filename</code>
<code> [10]      :EndIf</code>
<code> [11]      filename←_filenamePostfix{0=≢⍺:⍵ ⋄ ⍵,'_',⍺}filename</code>
<code> [12]      filename←_filenamePrefix{0=≢⍺:⍵ ⋄ ⍺,'_',⍵}filename</code>
<code> [13]      'No log filename specified and autoReOpen is 0'⎕SIGNAL 11/⍨0=≢filename</code>
<code> [14]  :Else</code>
<code class="emphasize">→[15]      'Something is wrong here!'⎕SIGNAL _debug/11</code>
<code class="emphasize">→[16]      rc←1</code>
<code class="emphasize">→[17]      qdmx←⎕DMX</code>
<code class="emphasize">→[18]      more←qdmx.EM</code>
<code> [19]  :EndTrap</code>
</div>
<code class="header" id="listing_5">#.Logger.Logger.WriteToLogfile &mdash; 74%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←WriteToLogfile(msg thisTimestamp)</code>
<code> [1]   ⎕TRAP←(⊂999 'N'),⎕TRAP</code>
<code> [2]   r←''</code>
<code> [3]   msg←msg,¨⊂CrLf</code>
<code> [4]   :If 0=≢_fileDescriptor</code>
<code> [5]       :If _debug</code>
<code> [6]           'Log file was already closed rc=11'⎕SIGNAL 999</code>
<code> [7]       :Else</code>
<code class="emphasize">→[8]           →0,_errorCounter+←1</code>
<code> [9]       :EndIf</code>
<code> [10]  :EndIf</code>
<code> [11]  (rc newFilename)←CheckForReopen ⍝ Check re-open condition</code>
<code> [12]  :Select rc</code>
<code> [13]  :Case ¯1</code>
<code class="emphasize">→[14]      'Re-Open check failed rc=11'⎕SIGNAL _debug/999</code>
<code class="emphasize">→[15]      →0,_errorCounter+←1</code>
<code> [16]  :Case 1</code>
<code> [17]      buffer←thisTimestamp,' (',(⍕⎕TID),') *** Log File is going to be closed and then reopened with a new filename',CrLf</code>
<code> [18]      buffer ⎕NAPPEND _fileDescriptor 80</code>
<code> [19]      ⎕NUNTIE _fileDescriptor</code>
<code> [20]      _fileDescriptor←⍬</code>
<code> [21]      Open newFilename</code>
<code> [22]      thisTimestamp←Timestamp 1</code>
<code> [23]  :Case 0</code>
<code> [24]                             ⍝ nothing to do, is still fine</code>
<code> [25]  :Case</code>
<code class="emphasize">→[26]      .                 ⍝ must not happen!</code>
<code> [27]  :EndSelect</code>
<code> [28]  flag←0</code>
<code> [29]  :Trap 0</code>
<code> [30]      (∊((Timestamp 1),' (',(⍕⎕TID),') ')∘,¨msg)⎕NAPPEND _fileDescriptor 80</code>
<code> [31]      r←msg</code>
<code> [32]  :Else</code>
<code class="emphasize">→[33]      _errorCounter+←1</code>
<code class="emphasize">→[34]      flag←1</code>
<code class="emphasize">→[35]      :Trap 0</code>
<code class="emphasize">→[36]          ((Timestamp 1),' (',(⍕⎕TID),')')∘{(⍺,' ',∊⍵,CrLf)⎕NAPPEND _fileDescriptor 80}¨buffer←(⊂'Invalid msg passed via:'),1↓(⎕LC{⍵,' [',(⍕⍺),']'}¨⎕XSI)</code>
<code> [37]      :EndTrap</code>
<code> [38]  :EndTrap</code>
<code> [39]  :If _printToSession</code>
<code> [40]      :If flag</code>
<code class="emphasize">→[41]          ⎕←↑PolishMsg buffer</code>
<code> [42]      :Else</code>
<code> [43]          ⎕←↑PolishMsg ¯2↓¨msg</code>
<code> [44]      :EndIf</code>
<code> [45]  :EndIf</code>
</div>
<code class="header" id="listing_6">#.Logger.Logger.ApplyMakeUp &mdash; 80%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (msg2 more2)←ApplyMakeUp(rc msg more)</code>
<code> [1]   msg2←more2←''</code>
<code> [2]   :Trap 0</code>
<code> [3]       :If 2=|≡msg</code>
<code> [4]           prefix←_errorPrefix,' RC=',(⍕rc),'; '</code>
<code> [5]           (⊃msg)←prefix,⊃msg</code>
<code> [6]           :If 1&lt;⍴msg</code>
<code> [7]               (1↓msg)←(⍴prefix)∘AddTrailingBlanks¨1↓msg</code>
<code> [8]           :EndIf</code>
<code> [9]       :Else</code>
<code class="emphasize">→[10]          msg←_errorPrefix,' RC=',(⍕rc),'; ',msg</code>
<code> [11]      :EndIf</code>
<code> [12]  :Else</code>
<code class="emphasize">→[13]      →0,_errorCounter+←1</code>
<code> [14]  :EndTrap</code>
<code> [15]  :Trap 0</code>
<code> [16]      :If 0=≢∊more</code>
<code> [17]          more←''</code>
<code> [18]      :Else</code>
<code> [19]          more←(1+⍴,_errorPrefix)∘AddTrailingBlanks¨more</code>
<code> [20]      :EndIf</code>
<code> [21]  :Else</code>
<code class="emphasize">→[22]      →0,_errorCounter+←1</code>
<code> [23]  :EndTrap</code>
<code> [24]  (msg2 more2)←msg more</code>
</div>
<code class="header" id="listing_7">#.Logger.Logger.Timestamp &mdash; 89%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Timestamp decoratorFlag</code>
<code> [1]      ⍝ 1=decoratorFlag ←→ yyyy-mm-dd hh:mm:ss</code>
<code> [2]      ⍝ 0=decoratorFlag ←→ yyyymmddhhmmss</code>
<code> [3]   :If 0≠≢_timestamp</code>
<code> [4]   :AndIf _debug</code>
<code> [5]       ts←6↑_timestamp</code>
<code> [6]   :Else</code>
<code> [7]       ts←6↑⎕TS</code>
<code> [8]   :EndIf</code>
<code> [9]   :If decoratorFlag</code>
<code> [10]      r←,'ZI4,&lt;-&gt;,ZI2,&lt;-&gt;,ZI2,&lt; &gt;,ZI2,&lt;:&gt;,ZI2,&lt;:&gt;,ZI2'⎕FMT,[0.5]ts</code>
<code> [11]  :ElseIf 0=decoratorFlag</code>
<code> [12]      r←,'ZI4,ZI2,ZI2,ZI2,ZI2,ZI2'⎕FMT,[0.5]3↑ts</code>
<code> [13]  :Else</code>
<code class="emphasize">→[14]      'Invalid right argument for "Timestamp" rc=11'⎕SIGNAL 999</code>
<code> [15]  :EndIf</code>
</div>
<code class="header" id="listing_8">#.Logger.Logger.CheckForReopen &mdash; 89%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (r newFilename)←CheckForReopen</code>
<code> [1]       ⍝ | `r←0` | if there is no need to re-open the log file.</code>
<code> [2]       ⍝ | `r←1` | if the log file needs to be re-opened.</code>
<code> [3]       ⍝ | r←¯1` | in case of an error.</code>
<code> [4]   newFilename←''</code>
<code> [5]   :If r←0≠≢,_autoReOpen</code>
<code> [6]       (rc hint newFilename)←MakeNewFilename _filename</code>
<code> [7]       :If 0≠rc</code>
<code class="emphasize">→[8]           hint ⎕SIGNAL _debug/rc</code>
<code class="emphasize">→[9]           →0,r←¯1</code>
<code> [10]      :EndIf</code>
<code> [11]      :If (0=≢,newFilename)∨~_autoReOpen</code>
<code> [12]          r←0</code>
<code> [13]      :Else</code>
<code> [14]          string←(⍴_filenamePrefix)↓_filename</code>
<code> [15]          :Select _filenameType</code>
<code> [16]          :Case 'DATE'</code>
<code> [17]              r←string[7 8]≢((⍴_filenamePrefix)↓newFilename)[7 8]</code>
<code> [18]          :Case 'MONTH'</code>
<code> [19]              r←string[5 6]≢((⍴_filenamePrefix)↓newFilename)[5 6]</code>
<code> [20]          :Case 'YEAR'</code>
<code> [21]              r←string[1 2 3 4]≢((⍴_filenamePrefix)↓newFilename)[1 2 3 4]</code>
<code> [22]          :Case ''</code>
<code> [23]              r←newFilename≢1⊃'.'A.Split _filename</code>
<code> [24]          :EndSelect</code>
<code> [25]      :EndIf</code>
<code> [26]  :EndIf</code>
</div>
<code class="header" id="listing_9">#.Logger.Logger.HandleEncoding &mdash; 89%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  txt←HandleEncoding txt</code>
<code> [1]   nestedFlag←0 1∧.&lt;|≡txt</code>
<code> [2]   txt←,⊆txt</code>
<code> [3]   :If _encoding≡'UTF8'</code>
<code> [4]       txt←⎕UCS¨'UTF-8'∘⎕UCS¨txt</code>
<code> [5]   :Else</code>
<code> [6]       :If _encoding≡'ANSI'</code>
<code> [7]           ansi←'1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM!"$%^&amp;*()-_=+]}[{#~''@;:/?.&gt;,&lt;\| ',⎕UCS 8 13 10</code>
<code> [8]           txt←ansi∘{0=+/bool←~(w←⍵)∊⍺:w ⋄ (bool/w)←'?' ⋄ w}¨,¨txt</code>
<code> [9]       :Else</code>
<code class="emphasize">→[10]          txt←{~(⎕DR ⍵)∊80 160:⍕⍵ ⋄ 0=+/bool←128&lt;⎕UCS w←⍵:⍵ ⋄ (bool/w)←'¿' ⋄ w}¨,¨txt  ⍝ replace non-ansi chars by "¿"</code>
<code> [11]      :EndIf</code>
<code> [12]  :EndIf</code>
<code> [13]  txt←∊⍣(⊃~nestedFlag)⊣txt</code>
</div>
<code class="header" id="listing_10">#.Logger.Logger.make4 &mdash; 91%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  make4(path_ encoding_ filenameType_ debug_)</code>
<code> [1]      ⍝ `debug` (default: 0) is a Boolean useful to switch error trapping off</code>
<code> [2]   :Access Public Instance</code>
<code> [3]   :Implements Constructor</code>
<code> [4]   Init ⍬</code>
<code> [5]   constructorIsRunning←1</code>
<code> [6]   InitialyzeProperties</code>
<code> [7]   _path←ProcessPath path_</code>
<code> [8]   :If 0=≢_encoding←ProcessEncoding encoding_</code>
<code class="emphasize">→[9]       'Invalid: "encoding"'⎕SIGNAL 11</code>
<code> [10]  :EndIf</code>
<code> [11]  filenameType←filenameType_</code>
<code> [12]  debug←debug_</code>
<code> [13]  (_errorCounter msg)←Create ⍬</code>
<code> [14]  SetDisplayFormat</code>
<code> [15]  msg ⎕SIGNAL 11/⍨_errorCounter</code>
</div>
<code class="header" id="listing_11">#.Logger.Logger.Log &mdash; 91%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←Log msg</code>
<code> [1]   :Access Public Instance</code>
<code> [2]      ⍝ Writes `msg` into the Log File.\\</code>
<code> [3]      ⍝ `r` gets the message written to the log file together with the time stamp and thread no.\\</code>
<code> [4]      ⍝ `msg` can be one of:</code>
<code> [5]      ⍝ * A vector</code>
<code> [6]      ⍝ * A matrix</code>
<code> [7]      ⍝ * A vector of vectors</code>
<code> [8]   ⎕TRAP←(999 'E' '({⍵↑⍨1⍳⍨''rc=''{⍺⍷⍵}⍵}⎕DMX.EM)⎕SIGNAL {⍎⍵↑⍨-''=''⍳⍨⌽⍵}⎕DMX.EM')((0 1000)'N')</code>
<code> [9]   r←''</code>
<code> [10]  :If _active</code>
<code> [11]      :Trap SetTrap 0</code>
<code> [12]          thisTimestamp←Timestamp 1</code>
<code> [13]          msg←,⊆{2=⍴⍴⍵:⊂[2]⍵ ⋄ ⍵}msg</code>
<code> [14]          msg←HandleEncoding msg</code>
<code> [15]          :If _fileFlag</code>
<code> [16]              r←WriteToLogfile msg thisTimestamp</code>
<code> [17]          :Else</code>
<code> [18]              ⎕←↑PolishMsg msg</code>
<code> [19]          :EndIf</code>
<code> [20]      :Else</code>
<code class="emphasize">→[21]          _errorCounter+←1</code>
<code> [22]      :EndTrap</code>
<code> [23]  :EndIf</code>
</div>
<code class="header" id="listing_12">#.Logger.Logger.make5 &mdash; 92%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  make5(path_ encoding_ filenameType_ debug_ timestamp_)</code>
<code> [1]      ⍝ `timestamp` defaults to `6↑⎕TS`. For testing purposes, for example the</code>
<code> [2]      ⍝ re-open feature of the `Logging` class, you can specify a particular timestamp.</code>
<code> [3]   :Access Public Instance</code>
<code> [4]   :Implements Constructor</code>
<code> [5]   Init ⍬</code>
<code> [6]   constructorIsRunning←1</code>
<code> [7]   InitialyzeProperties</code>
<code> [8]   _path←ProcessPath path_</code>
<code> [9]   :If 0=≢_encoding←ProcessEncoding encoding_</code>
<code class="emphasize">→[10]      'Invalid: "encoding"'⎕SIGNAL 11</code>
<code> [11]  :EndIf</code>
<code> [12]  filenameType←filenameType_</code>
<code> [13]  debug←debug_</code>
<code> [14]  timestamp←timestamp_</code>
<code> [15]  (_errorCounter msg)←Create ⍬</code>
<code> [16]  SetDisplayFormat</code>
<code> [17]  msg ⎕SIGNAL 11/⍨_errorCounter</code>
</div>
<code class="header" id="listing_13">#.Logger.Logger.make1 &mdash; 96%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  make1(pathOrParameterSpace)</code>
<code> [1]      ⍝ `pathOrParameterSpace` can be either a path to a folder where the log file</code>
<code> [2]      ⍝ will live, or a command space:</code>
<code> [3]      ⍝ | path          | Directory the log file is going to.</code>
<code> [4]      ⍝ | Command space | Useful to set all possible parameters.</code>
<code> [5]      ⍝ Note that you can ask</code>
<code> [6]      ⍝ `Logger` to create a command space for you, see the method `CreateParms`.</code>
<code> [7]      ⍝ Then simply set those where the defaults do not fit your needs and provide the namespace as argument to `⎕NEW`.</code>
<code> [8]   :Access Public Instance</code>
<code> [9]   :Implements Constructor</code>
<code> [10]  Init ⍬</code>
<code> [11]  constructorIsRunning←1</code>
<code> [12]  InitialyzeProperties</code>
<code> [13]  :If 9.1=⎕NC⊂'pathOrParameterSpace'</code>
<code> [14]  :AndIf 0=≡pathOrParameterSpace</code>
<code> [15]  ⍝ It is a command space</code>
<code> [16]      :If ∨/bool←2≠⎕NC↑'_',¨list←pathOrParameterSpace.⎕NL-2</code>
<code> [17]          11 ⎕SIGNAL⍨'Invalid keyword(s): ',⊃{⍺,',',⍵}/bool/list</code>
<code> [18]      :EndIf</code>
<code> [19]      'Missing: "active"'⎕SIGNAL 1/⍨~(⊂'active')∊list</code>
<code> [20]      :For this :In {⍵,'←',{' '=1↑0⍴⍵:'''',⍵,'''' ⋄ ⍵≡⍬:'⍬' ⋄ ⍕⍵}pathOrParameterSpace.⍎⍵}¨list~'filename' 'path' 'encoding'</code>
<code> [21]          ⍎this ⍝ not eached for easier debugging</code>
<code> [22]      :EndFor</code>
<code> [23]      :If (⊂'filename')∊list</code>
<code> [24]          _filename←pathOrParameterSpace.filename</code>
<code> [25]      :EndIf</code>
<code> [26]      :If (⊂'path')∊list</code>
<code> [27]          _path←ProcessPath pathOrParameterSpace.path</code>
<code> [28]      :EndIf</code>
<code> [29]      :If (⊂'encoding')∊list</code>
<code> [30]          :If 0=≢_encoding←ProcessEncoding pathOrParameterSpace.encoding</code>
<code class="emphasize">→[31]              'Invalid value: "encoding"'⎕SIGNAL 11</code>
<code> [32]          :EndIf</code>
<code> [33]      :EndIf</code>
<code> [34]      :If 0=≢_filename,_filenamePostfix,_filenamePrefix,_filenameType</code>
<code> [35]          'No "filenameType" specified but no "filename", "filenamePostfix", "filenamePrefix" either'⎕SIGNAL 11</code>
<code> [36]      :EndIf</code>
<code> [37]  :ElseIf ' '≠1↑0⍴∊pathOrParameterSpace</code>
<code> [38]      'Invalid parameters'⎕SIGNAL 11</code>
<code> [39]  :Else</code>
<code> [40]      _path←ProcessPath pathOrParameterSpace</code>
<code> [41]  :EndIf</code>
<code> [42]  (_errorCounter msg)←Create ⍬</code>
<code> [43]  SetDisplayFormat</code>
<code> [44]  msg ⎕SIGNAL 11/⍨_errorCounter</code>
</div>
<code class="header" id="listing_14">#.Logger.Logger.LogError &mdash; 96%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←LogError y</code>
<code> [1]   :Access Public Instance</code>
<code> [2]       ⍝ y is a two- or three-item vector with:</code>
<code> [3]       ⍝ | rc (Return code) | 0 means that `LogError` won't do anything at all.</code>
<code> [4]       ⍝ | msg              | Either a simple char vector or a vector of char vectors.</code>
<code> [5]       ⍝ | more (optional)  | Any array that has a depth of 2 or less and a rank of 2 or less.</code>
<code> [6]       ⍝ Returns an empty vector in case rc←0 otherwise what was printed to the log file.</code>
<code> [7]   r←''</code>
<code> [8]   ⎕TRAP←(999 'E' '({⍵↑⍨1⍳⍨''rc=''{⍺⍷⍵}⍵}⎕DMX.EM)⎕SIGNAL {⍎⍵↑⍨-''=''⍳⍨⌽⍵}⎕DMX.EM')((0 1000)'N')</code>
<code> [9]   :If ~2 3∊⍨⍴,y</code>
<code> [10]      :If _debug</code>
<code> [11]          'Length error - right argument'⎕SIGNAL 6</code>
<code> [12]      :Else</code>
<code> [13]          →0,_errorCounter+←1</code>
<code> [14]      :EndIf</code>
<code> [15]  :EndIf</code>
<code> [16]  (rc msg more)←3↑y,(⍴,y)↓0 '' ''</code>
<code> [17]  msg←{2=⍴⍴⍵:↓⍵ ⋄ ,⊆⍵}msg</code>
<code> [18]  more←⍕¨⊃,/{2=⍴⍴⍵:↓⍵ ⋄ ⊂,⍵}¨⊆⊃,/{2=⍴⍴⍵:↓⍵ ⋄ ⊂,⍵}more</code>
<code> [19]  :If 2=|≡msg</code>
<code> [20]      more←⊃,/{⍕¨{2=⍴⍴⍵:↓⍵ ⋄ ,⊆,⍵}⍵}¨more</code>
<code> [21]  :Else</code>
<code> [22]      more←⍕¨{2=⍴⍴⍵:↓⍵ ⋄ ,⊆,⍵}more</code>
<code> [23]  :EndIf</code>
<code> [24]  :If 2&lt;|≡more</code>
<code class="emphasize">→[25]      more←∊¨more</code>
<code> [26]  :EndIf</code>
<code> [27]  :If _active∧0≠rc</code>
<code> [28]      msg←MassageErrorMessage msg</code>
<code> [29]      msg←HandleEncoding msg</code>
<code> [30]      more←HandleEncoding more</code>
<code> [31]      (msg more)←ApplyMakeUp rc msg more</code>
<code> [32]      →(0=≢msg,more)/0</code>
<code> [33]      :Trap 0</code>
<code> [34]          :If _fileFlag</code>
<code> [35]              timestamp←Timestamp 1</code>
<code> [36]              r←WriteToLogfile msg timestamp</code>
<code> [37]              r,←WriteToLogfile more timestamp</code>
<code> [38]          :Else</code>
<code> [39]              ⎕←↑PolishMsg msg</code>
<code> [40]          :EndIf</code>
<code> [41]      :EndTrap</code>
<code> [42]  :EndIf</code>
</div>
<code class="header" id="listing_15">#.Logger.Logger.set_encoding &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_16">#.Logger.Logger.get_encoding &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_encoding</code>
<code> [1]  r←_encoding</code>
</div>
<code class="header" id="listing_17">#.Logger.Logger.set_autoReOpen &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_autoReOpen arg</code>
<code> [1]  'Must be a Boolean: "debug"'⎕SIGNAL 11/⍨~arg.NewValue∊0 1</code>
<code> [2]  _autoReOpen←arg.NewValue</code>
</div>
<code class="header" id="listing_18">#.Logger.Logger.get_autoReOpen &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_autoReOpen</code>
<code> [1]  r←_autoReOpen</code>
</div>
<code class="header" id="listing_19">#.Logger.Logger.set_filenameType &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_filenameType arg</code>
<code> [1]  buffer←1 ⎕C arg.NewValue</code>
<code> [2]  'Invalid filenameType'⎕SIGNAL 11/⍨~(⊂buffer)∊'DATE' 'YEAR' 'MONTH' ''</code>
<code> [3]  _filenameType←arg.NewValue</code>
</div>
<code class="header" id="listing_20">#.Logger.Logger.get_filenameType &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_filenameType</code>
<code> [1]  r←_filenameType</code>
</div>
<code class="header" id="listing_21">#.Logger.Logger.set_debug &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_debug arg</code>
<code> [1]  'Must be a Boolean'⎕SIGNAL 11/⍨~arg.NewValue∊0 1</code>
<code> [2]  _debug←arg.NewValue</code>
</div>
<code class="header" id="listing_22">#.Logger.Logger.get_debug &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_debug</code>
<code> [1]  r←_debug</code>
</div>
<code class="header" id="listing_23">#.Logger.Logger.set_printToSession &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_printToSession arg</code>
<code> [1]  'Must be a Boolean'⎕SIGNAL 11/⍨~arg.NewValue∊0 1</code>
<code> [2]  _printToSession←arg.NewValue</code>
</div>
<code class="header" id="listing_24">#.Logger.Logger.get_printToSession &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_printToSession</code>
<code> [1]  r←_printToSession</code>
</div>
<code class="header" id="listing_25">#.Logger.Logger.set_extension &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_extension arg</code>
<code> [1]  'Must be simple'⎕SIGNAL 11/⍨~0 1∊⍨|≡arg.NewValue</code>
<code> [2]  'Must be a string'⎕SIGNAL 11/⍨~A.IsChar arg.NewValue</code>
<code> [3]  _extension←arg.NewValue</code>
</div>
<code class="header" id="listing_26">#.Logger.Logger.get_extension &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_extension</code>
<code> [1]  r←_extension</code>
</div>
<code class="header" id="listing_27">#.Logger.Logger.set_timestamp &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_timestamp arg</code>
<code> [1]  →(0=≢,arg.NewValue)/0</code>
<code> [2]  'Invalid time stamp'⎕SIGNAL 11/⍨~(⍴,arg.NewValue)∊3 6</code>
<code> [3]  'Invalid time stamp'⎕SIGNAL 11/⍨∨/~(⎕DR¨arg.NewValue)∊163 83</code>
<code> [4]  _timestamp←6↑arg.NewValue</code>
</div>
<code class="header" id="listing_28">#.Logger.Logger.get_timestamp &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_timestamp</code>
<code> [1]  r←_timestamp</code>
</div>
<code class="header" id="listing_29">#.Logger.Logger.set_active &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_active arg</code>
<code> [1]  '"active" must be a Boolean'⎕SIGNAL 11/⍨~∨/arg.NewValue∊0 1</code>
<code> [2]  _active←arg.NewValue</code>
<code> [3]  :If _active∧_fileFlag</code>
<code> [4]  :AndIf 0=constructorIsRunning  ⍝ is set inside any constructor (locally!) to 1</code>
<code> [5]  :AndIf ⍬≡_fileDescriptor ⍝ means that the log file haven't got opened so far</code>
<code> [6]      (_errorCounter msg)←Create ⍬</code>
<code> [7]      msg ⎕SIGNAL 11/⍨_errorCounter</code>
<code> [8]  :EndIf</code>
</div>
<code class="header" id="listing_30">#.Logger.Logger.get_active &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_active</code>
<code> [1]  r←_active</code>
</div>
<code class="header" id="listing_31">#.Logger.Logger.set_fileFlag &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_fileFlag arg</code>
<code> [1]  '"fileFlag" must be a Boolean'⎕SIGNAL 11/⍨~∨/arg.NewValue∊0 1</code>
<code> [2]  _fileFlag←arg.NewValue</code>
<code> [3]  :If _fileFlag∧_active</code>
<code> [4]  :AndIf 0=constructorIsRunning     ⍝ is set inside any constructor (localysed!) to 1</code>
<code> [5]  :AndIf ⍬≡_fileDescriptor          ⍝ means that the log file haven't got opened so far</code>
<code> [6]      (_errorCounter msg)←Create ⍬</code>
<code> [7]      msg ⎕SIGNAL 11/⍨_errorCounter</code>
<code> [8]  :EndIf</code>
</div>
<code class="header" id="listing_32">#.Logger.Logger.get_fileFlag &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_fileFlag</code>
<code> [1]  r←_fileFlag</code>
</div>
<code class="header" id="listing_33">#.Logger.Logger.set_filenamePrefix &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_filenamePrefix arg</code>
<code> [1]  '"filenamePrefix" must be a string'⎕SIGNAL 11/⍨~A.IsChar arg.NewValue</code>
<code> [2]  _filenamePrefix←arg.NewValue</code>
</div>
<code class="header" id="listing_34">#.Logger.Logger.get_filenamePrefix &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_filenamePrefix</code>
<code> [1]  r←_filenamePrefix</code>
</div>
<code class="header" id="listing_35">#.Logger.Logger.set_filenamePostfix &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_filenamePostfix arg</code>
<code> [1]  '"filenamePostfix" must be a string'⎕SIGNAL 11/⍨~A.IsChar arg.NewValue</code>
<code> [2]  _filenamePostfix←arg.NewValue</code>
</div>
<code class="header" id="listing_36">#.Logger.Logger.get_filenamePostfix &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_filenamePostfix</code>
<code> [1]  r←_filenamePostfix</code>
</div>
<code class="header" id="listing_37">#.Logger.Logger.set_errorPrefix &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_errorPrefix arg</code>
<code> [1]  '"errorPrefix" must be a string'⎕SIGNAL 11/⍨~A.IsChar arg.NewValue</code>
<code> [2]  _errorPrefix←arg.NewValue</code>
</div>
<code class="header" id="listing_38">#.Logger.Logger.get_errorPrefix &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_errorPrefix</code>
<code> [1]  r←_errorPrefix</code>
</div>
<code class="header" id="listing_39">#.Logger.Logger.set_path &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_40">#.Logger.Logger.get_path &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_path</code>
<code> [1]  r←_path</code>
</div>
<code class="header" id="listing_41">#.Logger.Logger.set_filename &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_42">#.Logger.Logger.get_filename &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_filename</code>
<code> [1]  r←_filename</code>
</div>
<code class="header" id="listing_43">#.Logger.Logger.set_fileDescriptor &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_44">#.Logger.Logger.get_fileDescriptor &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_fileDescriptor</code>
<code> [1]  r←_fileDescriptor</code>
</div>
<code class="header" id="listing_45">#.Logger.Logger.set_errorCounter &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_46">#.Logger.Logger.get_errorCounter &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_errorCounter</code>
<code> [1]  r←_errorCounter</code>
</div>
<code class="header" id="listing_47">#.Logger.Logger.History &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  History</code>
<code> [1]   :Access Public shared</code>
<code> [2]        ⍝ * 6.0.0</code>
<code> [3]        ⍝   * Potentially breaking: `Version` now returns a char vector stemming form the package config file</code>
<code> [4]        ⍝   * Packages updated</code>
<code> [5]        ⍝   * "Make" improved</code>
<code> [6]        ⍝ * 5.0.1</code>
<code> [7]        ⍝   * Package config corrected</code>
<code> [8]        ⍝ * 5.0.0</code>
<code> [9]        ⍝   * BREAKING CHANGES:</code>
<code> [10]       ⍝     * Requires at least Dyalog 18.0</code>
<code> [11]       ⍝     * Requires the class `APLTreeUtils2`</code>
<code> [12]       ⍝     * Now delivered as a Tatin package</code>
<code> [13]       ⍝   * Documentation improved</code>
<code> [14]       ⍝   * Internal changes:</code>
<code> [15]       ⍝     * Does not `:Include APLTreeUtils` anymore</code>
<code> [16]       ⍝     * Uses `⎕ML←1`\\</code>
<code> [17]       ⍝ For information regarding older versions see &lt;https://github.com/aplteam/Logger/releases&gt;</code>
</div>
<code class="header" id="listing_48">#.Logger.Logger.make0 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  make0</code>
<code> [1]      ⍝ Intilaized with just the defaults.</code>
<code> [2]   :Access Public Instance</code>
<code> [3]   :Implements Constructor</code>
<code> [4]   Init ⍬</code>
<code> [5]   constructorIsRunning←1</code>
<code> [6]   InitialyzeProperties</code>
<code> [7]   (_errorCounter msg)←Create ⍬</code>
<code> [8]   SetDisplayFormat</code>
<code> [9]   msg ⎕SIGNAL 11/⍨_errorCounter</code>
</div>
<code class="header" id="listing_49">#.Logger.Logger.make2 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  make2(path_ encoding_)</code>
<code> [1]      ⍝ `encoding` is a character vector defining the encoding. You may specify `ANSI` (the default) and `UTF8` or `UTF-8`.\\</code>
<code> [2]      ⍝ Notes:</code>
<code> [3]      ⍝ * `ASCII` is not rejected but changed to `ANSI`</code>
<code> [4]      ⍝ * `UTF-8` is accepted but internally changed to `UTF8`</code>
<code> [5]   :Access Public Instance</code>
<code> [6]   :Implements Constructor</code>
<code> [7]   Init ⍬</code>
<code> [8]   constructorIsRunning←1</code>
<code> [9]   InitialyzeProperties</code>
<code> [10]  _encoding←ProcessEncoding encoding_</code>
<code> [11]  _path←ProcessPath path_</code>
<code> [12]  (_errorCounter msg)←Create ⍬</code>
<code> [13]  SetDisplayFormat</code>
<code> [14]  msg ⎕SIGNAL 11/⍨_errorCounter</code>
</div>
<code class="header" id="listing_50">#.Logger.Logger.make3 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  make3(path_ encoding_ filenameType_)</code>
<code> [1]      ⍝ `filenameType_` (default: 'DATE') defines when a log files is reopened with a new name.</code>
<code> [2]      ⍝ The default means that every night at 23:59:59 a new file is opened.</code>
<code> [3]      ⍝ Can be "MONTH" or "YEAR" instead.</code>
<code> [4]   :Access Public Instance</code>
<code> [5]   :Implements Constructor</code>
<code> [6]   Init ⍬</code>
<code> [7]   constructorIsRunning←1</code>
<code> [8]   InitialyzeProperties</code>
<code> [9]   _path←ProcessPath path_</code>
<code> [10]  _encoding←ProcessEncoding encoding_</code>
<code> [11]  filenameType←filenameType_</code>
<code> [12]  (_errorCounter msg)←Create ⍬</code>
<code> [13]  SetDisplayFormat</code>
<code> [14]  msg ⎕SIGNAL 11/⍨_errorCounter</code>
</div>
<code class="header" id="listing_51">#.Logger.Logger.InitialyzeProperties &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  InitialyzeProperties</code>
<code> [1]      ⍝ Guess what: initialyzes the properties.\\</code>
<code> [2]      ⍝ Called very early in the constructors but also by CreateParms</code>
<code> [3]   _active←1</code>
<code> [4]   _fileFlag←1</code>
<code> [5]   _debug←0                  ⍝ Switch of error trapping</code>
<code> [6]   _encoding←'ANSI'          ⍝ Either "ANSI" or "UTF".</code>
<code> [7]   _autoReOpen←1             ⍝ re-opens log file with a new name according to the "filenameType"</code>
<code> [8]   _filenameType←'DATE'      ⍝ default filenameType is "yyyymmdd" which is re-opened daily</code>
<code> [9]   _printToSession←0         ⍝ If this is 1, every entry is printed to the session as well</code>
<code> [10]  _path←''                  ⍝ Directory the log file will go into; empty=current dir</code>
<code> [11]  _filename←''              ⍝ the actual name</code>
<code> [12]  _timestamp←⍬              ⍝ To simulate []TS; ignored when debug=0</code>
<code> [13]  _extension←'log'          ⍝ File extension of the log file</code>
<code> [14]  _filenamePrefix←''        ⍝ Prefix added to "filename"; use this only when "filename" is empty</code>
<code> [15]  _filenamePostfix←''       ⍝ Postfix added to "filename"; use this only when "filename" is empty</code>
<code> [16]  _errorPrefix←'*** ERROR'  ⍝ How to prefix error entries in the log file</code>
<code> [17]  _fileDescriptor←⍬         ⍝ May indicate that "active" was 0 from the start!</code>
<code> [18]  _tieNumber←⍬              ⍝ Tie number of the log file or ⍬</code>
</div>
<code class="header" id="listing_52">#.Logger.Logger.Create &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {(r msg)}←Create dummy</code>
<code> [1]      ⍝ Is called by the "official" constructors but is private, strictly speaking.</code>
<code> [2]   r←0</code>
<code> [3]   msg←''</code>
<code> [4]   :If 0≠≢_filename</code>
<code> [5]   :AndIf _autoReOpen</code>
<code> [6]       r←1</code>
<code> [7]       msg←'"filename" MUST NOT be set with autoReOpen=1'</code>
<code> [8]       :Return</code>
<code> [9]   :EndIf</code>
<code> [10]  (r msg)←Open ⍬</code>
<code> [11]     ⍝Done</code>
</div>
<code class="header" id="listing_53">#.Logger.Logger.Init &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←Init dummy</code>
<code> [1]  r←⍬</code>
<code> [2]  A←(⊃⊃⎕CLASS ⎕THIS).##.APLTreeUtils2</code>
<code> [3]  F←(⊃⊃⎕CLASS ⎕THIS).##.FilesAndDirs</code>
</div>
<code class="header" id="listing_54">#.Logger.Logger.CreateParms &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←CreateParms</code>
<code> [1]   :Access Public Shared</code>
<code> [2]        ⍝ Use this to create a parameter space which can then be modified and finally</code>
<code> [3]        ⍝ passed to the constructor.\\</code>
<code> [4]        ⍝ Note that the resulting namespace contains a method `List` which prints</code>
<code> [5]        ⍝ all names and their values to the session.</code>
<code> [6]   r←⎕NS''</code>
<code> [7]   InitialyzeProperties</code>
<code> [8]   r.active←_active</code>
<code> [9]   r.encoding←_encoding</code>
<code> [10]  r.autoReOpen←_autoReOpen</code>
<code> [11]  r.debug←_debug</code>
<code> [12]  r.errorPrefix←_errorPrefix</code>
<code> [13]  r.extension←_extension</code>
<code> [14]  r.fileFlag←_fileFlag</code>
<code> [15]  r.filename←_filename</code>
<code> [16]  r.filenamePostfix←_filenamePostfix</code>
<code> [17]  r.filenamePrefix←_filenamePrefix</code>
<code> [18]  r.filenameType←_filenameType</code>
<code> [19]  r.path←_path</code>
<code> [20]  r.printToSession←_printToSession</code>
<code> [21]  r.timestamp←_timestamp</code>
<code> [22]  r.⎕FX'r←∆List;⎕IO' '⍝ List all variables and possible references in this namespace' '⎕IO←0' 'r←{⍵,[0.5]⍎¨⍵}'' ''~¨⍨↓⎕NL 2 9'</code>
</div>
<code class="header" id="listing_55">#.Logger.Logger.CreatePropertySpace &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←CreatePropertySpace</code>
<code> [1]  :Access Public Shared</code>
<code> [2]       ⍝ This method is now deprecated and exists only for compatability reasons.</code>
<code> [3]       ⍝ Use `CreateParms` instead.</code>
<code> [4]       ⍝ This brings `Logger` in line with all the other members of the APLTree project.</code>
<code> [5]  r←CreateParms</code>
</div>
<code class="header" id="listing_56">#.Logger.Logger.Close &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←Close</code>
<code> [1]  :Access Public</code>
<code> [2]     ⍝ Closes the log file</code>
<code> [3]  r←⍬</code>
<code> [4]  :Trap 0</code>
<code> [5]      Log'*** Log file closed'</code>
<code> [6]  :EndTrap</code>
<code> [7]  Close2</code>
<code> [8]  ⎕DF'[Logger:]'</code>
</div>
<code class="header" id="listing_57">#.Logger.Logger.FullFilename &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←FullFilename</code>
<code> [1]  :Access Public Instance</code>
<code> [2]     ⍝ Returns the fully qualified file name of the log file: path+filename.</code>
<code> [3]  r←F.NormalizePath _path,_filename</code>
</div>
<code class="header" id="listing_58">#.Logger.Logger.MassageErrorMessage &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> msg←MassageErrorMessage msg</code>
<code> [1]  msg←{2=⍴⍴⍵:↓⍵ ⋄ ⍵}msg</code>
<code> [2]  :If ~(≡msg)∊0 1</code>
<code> [3]  :AndIf 2≠|≡msg</code>
<code> [4]      'Invalid "msg"'⎕SIGNAL _debug/11</code>
<code> [5]      _errorCounter+←1</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_59">#.Logger.Logger.Cleanup &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Cleanup</code>
<code> [1]  :Implements Destructor</code>
<code> [2]  Close2</code>
</div>
<code class="header" id="listing_60">#.Logger.Logger.Close2 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←Close2</code>
<code> [1]   ⍝ When the destructor (which calls "Close2"!) is finally executed _</code>
<code> [2]   ⍝ the tie number originally used might well have be re-used by something _</code>
<code> [3]   ⍝ else. That's the reason why we use a randomly generated tie number, _</code>
<code> [4]   ⍝ and it also means that we need to check whether the file is still _</code>
<code> [5]   ⍝ associated with the original (or any) file. Only then takes the</code>
<code> [6]   ⍝ destructor action.</code>
<code> [7]   r←⍬</code>
<code> [8]   :If 0&lt;⎕NC'_fileDescriptor'</code>
<code> [9]   :AndIf ⍬≢_fileDescriptor</code>
<code> [10]  :AndIf _fileDescriptor∊⎕NNUMS</code>
<code> [11]  :AndIf (F.NormalizePath _path,_filename)≡(⎕NNUMS⍳_fileDescriptor)⊃F.NNAMES</code>
<code> [12]      ⎕NUNTIE _fileDescriptor</code>
<code> [13]      _fileDescriptor←⍬</code>
<code> [14]      _filename←''</code>
<code> [15]  :EndIf</code>
</div>
<code class="header" id="listing_61">#.Logger.Logger.SetDisplayFormat &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←SetDisplayFormat</code>
<code> [1]  r←''</code>
<code> [2]  ⎕DF'[Logger:',_path,_filename,'(',(⍕_fileDescriptor),')]'</code>
</div>
<div id="footer">
<hr>
<p>Created by "CodeCoverage" version 0.10.7+52 from 2024-06-05</p>
</div>

</body>
</html>
